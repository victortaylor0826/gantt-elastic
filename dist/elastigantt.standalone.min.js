var Elastigantt=function(){"use strict";const t={el:"#elastigantt",data:{tasks:[],options:{}}};var e=function(){var t=this.$createElement;return(this._self._c||t)("elastigantt",{attrs:{tasks:this.tasks,options:this.options}})};e._withStripped=!0;var s=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\Elastigantt.standalone.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:e,staticRenderFns:[]},0,t,void 0,!1);let i=null;const a={inject:["root"],data:()=>({localScale:0}),created(){this.localScale=this.root.state.times.timeZoom},methods:{getImage(){this.root.getImage("image/png").then(t=>{const e=document.createElement("a");e.href=t,e.download="Elastigantt.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)})},recenterPosition(){this.$root.$emit("elastigantt.recenterPosition")},setScale(t){null!==i&&(clearTimeout(i),i=null),i=setTimeout(()=>{this.$root.$emit("elastigantt.times.timeZoom.change",t),i=null},75)}},computed:{scale:{get(){return this.localScale},set(t){this.localScale=Number(t),this.setScale(this.localScale)}},height:{get(){return this.root.state.row.height},set(t){this.$root.$emit("elastigantt.row.height.change",Number(t))}},scope:{get(){return this.root.state.scope.before},set(t){this.$root.$emit("elastigantt.scope.change",Number(t)),this.$root.$emit("elastigantt.scope.before.change",Number(t)),this.$root.$emit("elastigantt.scope.after.change",Number(t))}},divider:{get(){return this.root.state.taskList.percent},set(t){this.$root.$emit("elastigantt.taskList.width.change",Number(t))}}}};var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"elastigantt__header"},[s("div",{staticStyle:{float:"left","font-size":"22px","letter-spacing":"1px"}},[t._v(t._s(t.root.state.title))]),t._v(" "),s("div",{staticClass:"elastigantt__header-options"},[s("button",{staticClass:"elastigantt__btn-recenter btn btn-primary mr-4",on:{click:t.recenterPosition}},[t._v(t._s(t.root.state.locale.Now))]),t._v(" "),s("label",{staticClass:"mr-2"},[t._v(t._s(t.root.state.locale["X-Scale"])),s("input",{directives:[{name:"model",rawName:"v-model",value:t.scale,expression:"scale"}],attrs:{type:"range",max:"24",min:"2"},domProps:{value:t.scale},on:{__r:function(e){t.scale=e.target.value}}})]),t._v(" "),s("label",{staticClass:"mr-2"},[t._v(t._s(t.root.state.locale["Y-Scale"])),s("input",{directives:[{name:"model",rawName:"v-model",value:t.height,expression:"height"}],attrs:{type:"range",max:"100",min:"6"},domProps:{value:t.height},on:{__r:function(e){t.height=e.target.value}}})]),t._v(" "),s("label",{staticClass:"mr-2"},[t._v(t._s(t.root.state.locale["Before/After"])),s("input",{directives:[{name:"model",rawName:"v-model",value:t.scope,expression:"scope"}],attrs:{type:"range",max:"31",min:"0"},domProps:{value:t.scope},on:{__r:function(e){t.scope=e.target.value}}})]),t._v(" "),s("label",{staticClass:"mr-2"},[t._v(t._s(t.root.state.locale["Task list width"])),s("input",{directives:[{name:"model",rawName:"v-model",value:t.divider,expression:"divider"}],attrs:{type:"range",max:"100",min:"0"},domProps:{value:t.divider},on:{__r:function(e){t.divider=e.target.value}}})]),t._v(" "),s("label",{staticClass:"mr-2"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.root.state.taskList.display,expression:"root.state.taskList.display"}],staticClass:"mr-1",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.root.state.taskList.display)?t._i(t.root.state.taskList.display,null)>-1:t.root.state.taskList.display},on:{change:function(e){var s=t.root.state.taskList.display,i=e.target,a=!!i.checked;if(Array.isArray(s)){var r=t._i(s,null);i.checked?r<0&&t.$set(t.root.state.taskList,"display",s.concat([null])):r>-1&&t.$set(t.root.state.taskList,"display",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.root.state.taskList,"display",a)}}}),t._v(t._s(t.root.state.locale["Display task list"]))])])])};r._withStripped=!0;var o=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Header.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:r,staticRenderFns:[]},0,a,void 0,!1);const n={inject:["root"],props:["column"],data:()=>({}),computed:{getStyle(){this.root.state;return{height:"100%",width:root.state.taskList.resizerWidth+"px"}}}};var l=function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"elastigantt__task-list-resizer",staticStyle:{}})};l._withStripped=!0;var h=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\TaskList\\Resizer.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:l,staticRenderFns:[]},0,n,void 0,!1);const d={inject:["root"],props:["tasks"],data:()=>({border:.5,borderStyle:{fill:"#ffffffa0",stroke:"#000000","stroke-width":.5},lineOffset:5,lineStyle:{fill:"transparent",stroke:"#000000","stroke-width":1,"stroke-linecap":"round"}}),computed:{allChildren(){const t=[];return this.tasks.forEach(e=>{e.allChildren.forEach(e=>{t.push(e)})}),t},collapsed(){if(0===this.tasks.length)return!1;let t=0;for(let e=0,s=this.tasks.length;e<s;e++)this.tasks[e].collapsed&&t++;return t===this.tasks.length}},methods:{toggle(){if(0===this.allChildren.length)return;const t=!this.collapsed;this.tasks.forEach(e=>{e.collapsed=t,e.allChildren.forEach(e=>{e.visible=!t&&!e.parent.collapsed})})}}};var c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"elastigantt__task-list-column-expander",style:t.root.state.taskList.styles.expander.wrapper},[s("svg",{style:t.root.state.taskList.styles.expander.content,attrs:{width:t.root.state.taskList.expander.size,height:t.root.state.taskList.expander.size}},[t.allChildren.length?s("rect",{style:t.root.state.taskList.styles.expander,attrs:{x:t.border,y:t.border,width:t.root.state.taskList.expander.size-2*t.border,height:t.root.state.taskList.expander.size-2*t.border,rx:"2",ry:"2"},on:{click:t.toggle}}):t._e(),t._v(" "),t.allChildren.length?s("line",{style:t.lineStyle,attrs:{x1:t.lineOffset,y1:t.root.state.taskList.expander.size/2,x2:t.root.state.taskList.expander.size-t.lineOffset,y2:t.root.state.taskList.expander.size/2},on:{click:t.toggle}}):t._e(),t._v(" "),t.collapsed?s("line",{style:t.lineStyle,attrs:{x1:t.root.state.taskList.expander.size/2,y1:t.lineOffset,x2:t.root.state.taskList.expander.size/2,y2:t.root.state.taskList.expander.size-t.lineOffset},on:{click:t.toggle}}):t._e()])])};c._withStripped=!0;var m=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\TaskList\\Expander.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:c,staticRenderFns:[]},0,d,void 0,!1);const p={components:{TaskListExpander:m},inject:["root"],props:["expanderStyle"],data:()=>({resizer:{moving:!1,x:0}}),computed:{getStyle(){return t=>{const e=this.root.state;return Object.assign({height:e.calendar.height+e.calendar.styles.column["stroke-width"]+"px","margin-bottom":e.calendar.gap+"px",width:t.finalWidth+"px"},e.taskList.styles.header)}},collapsible(){return this.root.state.tasks.filter(t=>t.allChildren.length>0)}},methods:{resizerMouseDown(t,e){this.resizerMoving||(this.resizer.moving=e,this.resizer.x=t.clientX,this.resizer.initialWidth=e.width,this.$root.$emit("elastigantt.taskList.column.width.change.start",this.resizer.moving.width))},resizerMouseMove(t){this.resizer.moving&&(this.resizer.moving.width=this.resizer.initialWidth+t.clientX-this.resizer.x,this.$root.$emit("elastigantt.taskList.column.width.change",this.resizer.moving.width))},resizerMouseUp(t){this.resizer.moving&&(this.$root.$emit("elastigantt.taskList.column.width.change",this.resizer.moving.width),this.$root.$emit("elastigantt.taskList.column.width.change.stop",this.resizer.moving.width),this.resizer.moving=!1)}},created(){this.$root.$on("elastigantt.main.mousemove",this.resizerMouseMove),this.$root.$on("elastigantt.main.mouseup",this.resizerMouseUp)}};var g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"elastigantt__task-list-header"},t._l(t.root.state.taskList.columns,function(e){return s("div",{key:e._id,staticClass:"elastigantt__task-list-header-column",style:t.getStyle(e)},[e.expander?s("task-list-expander",{style:t.expanderStyle,attrs:{tasks:t.collapsible}}):t._e(),t._v(" "),s("div",{staticClass:"elastigantt__task-list-header-label",style:e.styles.label,attrs:{column:e},on:{mouseup:function(s){t.resizerMouseUp(s,e)}}},[t._v(t._s(e.label))]),t._v(" "),s("div",{staticClass:"elastigantt__task-list-header-resizer",attrs:{column:e},on:{mousedown:function(s){t.resizerMouseDown(s,e)}}})],1)}))};g._withStripped=!0;var u=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\TaskList\\TaskListHeader.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:g,staticRenderFns:[]},0,p,void 0,!1);const f={inject:["root"],props:["column","task"],data:()=>({}),computed:{html(){return void 0!==this.column.html&&!0===this.column.html},value(){return"function"==typeof this.column.value?this.column.value(this.task):this.task[this.column.value]}}};var y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"elastigantt__task-list-item-column",style:t.column.style},[s("div",{staticClass:"elastigantt__task-list-item-value--wrapper"},[t._t("default"),t._v(" "),t.html?t._e():s("div",{staticClass:"elastigantt__task-list-item-value",style:t.column.styles.value},[t._v(t._s(t.value))]),t._v(" "),t.html?s("div",{staticClass:"elastigantt__task-list-item-value",style:t.column.styles.value,domProps:{innerHTML:t._s(t.value)}}):t._e()],2)])};y._withStripped=!0;const k={components:{TaskListExpander:m,ItemColumn:function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\TaskList\\ItemColumn.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:y,staticRenderFns:[]},0,f,void 0,!1)},inject:["root"],props:["task","expanderStyle"],data:()=>({})};var v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"elastigantt__task-list-item",style:t.root.state.taskList.styles.row},t._l(t.root.state.taskList.columns,function(e){return s("item-column",{key:e._id,attrs:{column:e,task:t.task}},[e.expander?s("task-list-expander",{style:t.expanderStyle,attrs:{tasks:[t.task]}}):t._e()],1)}))};v._withStripped=!0;const _={components:{TaskListResizer:h,TaskListHeader:u,TaskListItem:function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\TaskList\\TaskListItem.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:v,staticRenderFns:[]},0,k,void 0,!1)},inject:["root"],data:()=>({}),computed:{getHeaderExpanderStyle(){const t=this.root.state;this.root.getMaximalLevel(),t.taskList.expander.padding;return Object.assign({},t.taskList.styles.header,{width:(t.taskList.expander.width+t.calendar.styles.column["stroke-width"]+t.taskList.expander.margin)/100*t.taskList.percent+"px",height:t.calendar.height+t.calendar.styles.column["stroke-width"]+"px","margin-bottom":t.calendar.gap+"px","padding-right":t.taskList.expander.margin+"px","padding-left":t.taskList.expander.margin+"px",margin:"auto 0px",display:"inline-flex"})},getListExpanderStyle(){return t=>{const e=this.root.state,s=(t.parents.length-1)*e.taskList.expander.padding,i=this.root.getMaximalLevel();e.taskList.expander.padding;let a=e.row.height+2*e.grid.horizontal.gap-e.grid.horizontal.style.strokeWidth,r=(e.taskList.expander.size+e.calendar.styles.column["stroke-width"]+s+e.taskList.expander.margin)/100*e.taskList.percent;return e.taskList.expander.straight&&(r=(i-1)*e.taskList.expander.size+2*e.taskList.expander.padding),{width:r+"px",height:a+"px","border-color":"#00000010","padding-left":s+e.taskList.expander.margin+"px",margin:"auto 0px"}}}}};var w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.root.state.taskList.display?s("foreignObject",{staticClass:"elastigantt__task-list-object",attrs:{x:"0",y:"0",width:"100%",height:"100%"}},[s("div",{staticClass:"elastigantt__task-list-container",attrs:{xmlns:"http://www.w3.org/1999/xhtml"}},[s("div",{domProps:{innerHTML:t._s(t.root.state.defs.join(""))}}),t._v(" "),s("task-list-resizer"),t._v(" "),s("task-list-header",{attrs:{"expander-style":t.getHeaderExpanderStyle}}),t._v(" "),t._l(t.root.visibleTasks,function(e){return s("task-list-item",{key:e.id,attrs:{task:e,"expander-style":t.getListExpanderStyle(e)}})})],2)]):t._e()};w._withStripped=!0;var x=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\TaskList\\TaskList.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:w,staticRenderFns:[]},0,_,void 0,!1);const T={inject:["root"],data:()=>({verticalLines:[],horizontalLines:[]}),created(){this.$root.$on("elastigantt.recenterPosition",this.recenterPosition),this.$root.$on("elastigantt.scope.change",this.regenerate),this.$root.$on("elastigantt.times.timeZoom.change",this.regenerate),this.$root.$on("elastigantt.row.height.change",this.regenerate),this.$root.$on("elastigantt.tree.scroll",this.regenerate),this.regenerate()},methods:{recenterPosition(){this.root.scrollToTime(this.timeLinePosition.time)},generateVerticalLines(){let t=[];const e=this.root.state;return e.times.steps.forEach(s=>{t.push({key:s.date.valueOf(),x1:s.offset.px,y1:e.calendar.height+e.calendar.styles.column["stroke-width"]+e.calendar.gap,x2:s.offset.px,y2:e.calendar.height+e.calendar.styles.column["stroke-width"]+e.calendar.gap+e.tasks.length*(e.row.height+2*e.grid.horizontal.gap)+e.grid.horizontal.style.strokeWidth,inViewPort:this.root.isInsideViewPort(s.offset.px,1)})}),this.verticalLines=t},generateHorizontalLines(){let t=[];const e=this.root.state;for(let s=0,i=this.root.visibleTasks.length;s<=i;s++)t.push({key:"hl"+s,x1:0,y1:s*(e.row.height+2*e.grid.horizontal.gap)+e.calendar.height+e.calendar.styles.column["stroke-width"]+e.calendar.gap+e.grid.horizontal.style.strokeWidth/2,x2:"100%",y2:s*(e.row.height+2*e.grid.horizontal.gap)+e.calendar.height+e.calendar.styles.column["stroke-width"]+e.calendar.gap+e.grid.horizontal.style.strokeWidth/2});return this.horizontalLines=t},regenerate(){this.$nextTick(()=>{this.generateVerticalLines(),this.generateHorizontalLines()})}},computed:{inViewPort(){return t=>{const e=this.root.state;return t.x1>=e.scroll.tree.left&&t.x1<=e.scroll.tree.right}},timeLinePosition(){const t=this.root.state,e=new Date,s=e.getTime(),i=this.root.timeToPixelOffsetX(s),a={x:0,y1:t.calendar.height+t.calendar.gap,y2:"100%",dateTime:"",time:s};return a.x=i,a.dateTime=e.toLocaleDateString(),a},getVStyle(){return this.root.state.grid.vertical.style},getHStyle(){return this.root.state.grid.horizontal.style}}};var $=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",[t._l(t.horizontalLines,function(e,i){return s("line",{key:e.key,staticClass:"elastigantt__grid-horizontal-line",style:t.getHStyle,attrs:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}})}),t._v(" "),t._l(t.verticalLines,function(e,i){return e.inViewPort?s("line",{key:e.key,staticClass:"elastigantt__grid-vertical-line",style:t.getVStyle,attrs:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}}):t._e()}),t._v(" "),s("line",{staticClass:"elastigantt__grid-time-line",style:t.root.state.grid.timeLine.style,attrs:{x1:t.timeLinePosition.x,y1:t.timeLinePosition.y1,x2:t.timeLinePosition.x,y2:t.timeLinePosition.y2}})],2)};$._withStripped=!0;var L=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Grid\\Grid.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:$,staticRenderFns:[]},0,T,void 0,!1);const b={inject:["root"],props:["item"],data:()=>({}),computed:{getTextX(){return this.item.x+this.item.width/2},getTextY(){return this.item.y+this.item.height/2}}};var S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticClass:"elastigantt__calendar-row-group"},[s("rect",{staticClass:"elastigantt__calendar-row",style:t.root.state.calendar.styles.row,attrs:{x:t.item.x,y:t.item.y,width:t.item.width,height:t.item.height}}),t._v(" "),s("text",{style:t.root.state.calendar.styles.text,attrs:{x:t.getTextX,y:t.getTextY,"alignment-baseline":"middle","text-anchor":"middle"}},[t._v(t._s(t.item.label))])])};S._withStripped=!0;const C={components:{CalendarRow:function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Calendar\\CalendarRow.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:S,staticRenderFns:[]},0,b,void 0,!1)},inject:["root"],data:()=>({hours:[],days:[],months:[]}),created(){this.$root.$on("elastigantt.scope.change",this.regenerate),this.$root.$on("elastigantt.times.timeZoom.change",this.regenerate),this.regenerate()},methods:{howManyHoursFit(t){dayjs(this.root.state.times.steps[t].date);const e=this.root.state.calendar.styles.column["stroke-width"]+2;let s=this.root.state.times.steps[t].width.px,i=Object.keys(this.root.state.calendar.hour.format);for(let t=24;t>1;t=Math.ceil(t/2))for(let a of i)if((this.root.state.calendar.hour.maxWidths[a]+e)*t<=s&&t>1)return{count:t,type:a};return{count:0,type:""}},howManyDaysFit(){dayjs(this.root.state.times.steps[0].date);const t=this.root.state.calendar.styles.column["stroke-width"]+2;let e=this.root.state.width,s=Object.keys(this.root.state.calendar.day.format);for(let i=this.root.state.times.steps.length;i>1;i=Math.ceil(i/2))for(let a of s)if((this.root.state.calendar.day.maxWidths[a]+t)*i<=e&&i>1)return{count:i,type:a};return{count:0,type:""}},howManyMonthsFit(){dayjs(this.root.state.times.firstDate);const t=this.root.state.calendar.styles.column["stroke-width"]+2;let e=this.root.state.width,s=Object.keys(this.root.state.calendar.month.format);this.root.state.times.firstDate.month();let i=dayjs(this.root.state.times.firstDate),a=i.clone();const r=this.root.state.times.lastTime;let o=1;for(;i.valueOf()<=r;)i=i.add(1,"day"),a.month()!=i.month()&&o++,a=i.clone();for(let i=o;i>1;i=Math.ceil(i/2))for(let a of s)if((this.root.state.calendar.month.maxWidths[a]+t)*i<=e&&i>1)return{count:i,type:a};return{count:1,type:s[0]}},hourTextStyle(){return"font-family:"+this.root.state.calendar.hour.fontFamily+";font-size:"+this.root.state.calendar.hour.fontSize},dayTextStyle(){return"font-family:"+this.root.state.calendar.day.fontFamily+";font-size:"+this.root.state.calendar.day.fontSize},generateHours(){let t=[];for(let e=0,s=this.root.state.times.steps.length;e<s;e++){const s=this.howManyHoursFit(e),i=24/s.count,a=this.root.state.times.steps[e].width.px/s.count;for(let r=0,o=s.count;r<o;r++){const o=dayjs(this.root.state.times.steps[e].date).add(r*i,"hour");t.push({key:this.root.state.times.steps[e].date.valueOf()+"h"+r,x:this.root.state.calendar.styles.column["stroke-width"]/2+this.root.state.times.steps[e].offset.px+a*r,y:this.root.state.calendar.styles.column["stroke-width"]/2+this.root.state.calendar.day.height+this.root.state.calendar.month.height,width:a,height:this.root.state.calendar.hour.height,label:this.root.state.calendar.hour.format[s.type](o)})}}return this.hours=t},generateDays(){let t=[];const e=this.howManyDaysFit(),s=Math.ceil(this.root.state.times.steps.length/e.count);for(let i=0,a=this.root.state.times.steps.length;i<a;i+=s){let a=0;for(let t=0;t<s;t++)void 0!==this.root.state.times.steps[i+t]&&(a+=this.root.state.times.steps[i+t].width.px);const r=dayjs(this.root.state.times.steps[i].date);t.push({key:this.root.state.times.steps[i].date.valueOf()+"d",x:this.root.state.calendar.styles.column["stroke-width"]/2+this.root.state.times.steps[i].offset.px,y:this.root.state.calendar.styles.column["stroke-width"]/2+this.root.state.calendar.month.height,width:a,height:this.root.state.calendar.day.height,label:this.root.state.calendar.day.format[e.type](r)})}return this.days=t},generateMonths(){let t=[];const e=this.howManyMonthsFit();let s=Object.keys(this.root.state.calendar.month.format),i=dayjs(this.root.state.times.firstDate);for(let a=0;a<e.count;a++){let e=0,r=Number.MAX_SAFE_INTEGER,o=dayjs(i).add(1,"month").startOf("month");o.valueOf()>this.root.state.times.lastDate.valueOf()&&(o=dayjs(this.root.state.times.lastDate));for(let t=0,s=this.root.state.times.steps.length;t<s;t++){let s=this.root.state.times.steps[t];s.date.valueOf()>=i.valueOf()&&s.date.valueOf()<o.valueOf()&&(e+=s.width.px,s.offset.px<r&&(r=s.offset.px))}let n="";for(let t of s)this.root.state.calendar.month.maxWidths[t]+2<=e&&(n=this.root.state.calendar.month.format[t](i));t.push({key:a+"m",x:this.root.state.calendar.styles.column["stroke-width"]/2+r,y:this.root.state.calendar.styles.column["stroke-width"]/2,width:e,height:this.root.state.calendar.month.height,label:n}),(i=i.add(1,"month").startOf("month")).valueOf()>this.root.state.times.lastDate.valueOf()&&(i=dayjs(this.root.state.times.lastDate))}return this.months=t},regenerate(){this.$nextTick(()=>{this.generateHours(),this.generateDays(),this.generateMonths()})}},computed:{getX(){return this.root.state.calendar.styles.column["stroke-width"]/2},getY(){return this.root.state.calendar.styles.column["stroke-width"]/2},getWidth(){return this.root.state.width-this.root.state.calendar.styles.column["stroke-width"]}}};var F=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticClass:"elastigantt__calendar-group"},[s("foreignObject",{attrs:{x:t.getX,y:t.getY,width:t.getWidth,height:t.root.state.calendar.height}},[s("div",{staticClass:"elastigantt__calendar",style:t.root.state.calendar.styles.wrapper,attrs:{xmlns:"http://www.w3.org/1999/xhtml"}})]),t._v(" "),t._l(t.months,function(t,e){return s("calendar-row",{key:t.key,attrs:{item:t}})}),t._v(" "),t._l(t.days,function(e,i){return t.root.isInsideViewPort(e.x,e.width)?s("calendar-row",{key:e.key,attrs:{item:e}}):t._e()}),t._v(" "),t._l(t.hours,function(e,i){return t.root.isInsideViewPort(e.x,e.width)?s("calendar-row",{key:e.key,attrs:{item:e}}):t._e()})],2)};F._withStripped=!0;var O=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Calendar\\Calendar.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:F,staticRenderFns:[]},0,C,void 0,!1);const P={inject:["root"],props:["tasks"],data:()=>({}),methods:{getPoints(t,e){this.root.state;const s=this.root.getTask(t),i=this.root.getTask(e);if(!i.visible||!s.visible)return"";const a=s.x+s.width,r=s.y+s.height/2,o=i.x,n=i.y+i.height/2,l=o-a;let h,d=1;n>=r?h=n-r:(h=r-n,d=-1);let c=`M ${a} ${r}\n          L ${a+10},${r} `;return c+=l<=14?`Q ${a+10+4},${r} ${a+10+4},${r+4*d}\n            L ${a+10+4},${r+h*d/2-4*d}\n            Q ${a+10+4},${r+h*d/2} ${a+10},${r+h*d/2}\n            L ${a-10+l},${r+h*d/2}\n            Q ${a-10+l-4},${r+h*d/2} ${a-10+l-4},${r+h*d/2+4*d}\n            L ${a-10+l-4},${n-4*d}\n            Q ${a-10+l-4},${n} ${a-10+l},${n}\n            L ${o},${n}`:`L ${a+l/2-4},${r}\n            Q ${a+l/2},${r} ${a+l/2},${r+4*d}\n            L ${a+l/2},${n-4*d}\n            Q ${a+l/2},${n} ${a+l/2+4},${n}\n            L ${o},${n}`}},computed:{dependencyTasks(){return this.tasks.filter(t=>void 0!==t.dependentOn).map(t=>(t.dependencyLines=t.dependentOn.map(e=>({points:this.getPoints(e,t.id)})),t))}}};var R=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticClass:"elastigantt__tree-dependency-lines-container"},t._l(t.dependencyTasks,function(e){return s("g",{key:e.id,attrs:{task:e}},t._l(e.dependencyLines,function(i){return s("path",{key:i.id,style:t.root.state.dependencyLines.style,attrs:{task:e,d:i.points}})}))}))};R._withStripped=!0;var j=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Tree\\DependencyLines.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:R,staticRenderFns:[]},0,P,void 0,!1);const M={inject:["root"],props:["task"],data:()=>({}),computed:{getWidth(){const t=this.root.state.treeText.styles.text;return this.root.state.ctx.font=`${t["font-weight"]} ${t["font-size"]} ${t["font-family"]}`,this.root.state.ctx.measureText(this.task.label).width+2*this.root.state.treeText.xPadding}}};var z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("svg",{attrs:{x:t.task.x+t.task.width+t.root.state.treeText.offset,y:t.task.y,width:t.getWidth,height:t.task.height}},[s("rect",{style:t.root.state.treeText.styles.background,attrs:{x:"0",y:"0",width:"100%",height:"100%"}}),t._v(" "),s("text",{style:t.root.state.treeText.styles.text,attrs:{x:t.root.state.treeText.xPadding,y:"50%","alignment-baseline":"middle"}},[t._v(t._s(t.task.label))])])};z._withStripped=!0;var D=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Tree\\Text.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:z,staticRenderFns:[]},0,M,void 0,!1);const W={inject:["root"],props:["task"],data:()=>({}),computed:{getX(){this.root.state;this.root.state.ctx.font=`${root.state.info.fontWeight} ${root.state.info.fontSize} ${root.state.info.fontFamily}`;const t=this.root.state.ctx.measureText(this.task.label).width/2+10;return this.task.x+this.task.width/2-t},getWidth(){return this.root.state.ctx.measureText(this.task.label).width+20},getTextStyle(){this.root.state;return`${root.state.info.textStyle};font-family:${root.state.info.fontFamily};font-size:${root.state.info.fontSize};font-weight:${root.state.info.fontWeight};`}}};var E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("svg",{staticClass:"elastigantt__info",attrs:{x:t.getX,y:t.task.y,width:t.getWidth,height:t.root.state.row.height,xmlns:"http://www.w3.org/2000/svg"}},[s("rect",{style:t.root.state.info.style,attrs:{x:"0",y:"0",width:"100%",height:"100%"}}),t._v(" "),s("text",{style:t.getTextStyle,attrs:{x:"50%",y:"50%","text-anchor":"middle","alignment-baseline":"middle"}},[t._v(t._s(t.task.label))])])};E._withStripped=!0;var I=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Tree\\Info.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:E,staticRenderFns:[]},0,W,void 0,!1);const H={inject:["root"],props:["task"],data:()=>({}),computed:{getProgressWidth(){return this.task.progress+"%"},getLinePoints(){const t=this.task.width/100*this.task.progress;return`M ${t} 0 L ${t} ${this.task.height}`},getSolidStyle(){return Object.assign({},this.root.state.progress.styles.bar.solid,this.task.progressBarStyle.bar)},getLineStyle(){return Object.assign({},{stroke:this.root.state.row.styles.bar.stroke+"a0","stroke-width":this.root.state.row.styles.bar["stroke-width"]/2},this.task.style)}}};var V=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticClass:"elastigantt__tree-row-progress-bar"},[s("defs",[s("pattern",{attrs:{id:"diagonalHatch",width:t.root.state.progress.width,height:t.root.state.progress.width,patternTransform:"rotate(45 0 0)",patternUnits:"userSpaceOnUse"}},[s("line",{style:t.root.state.progress.styles.line,attrs:{x1:"0",y1:"0",x2:"0",y2:t.root.state.progress.width}})])]),t._v(" "),t.root.state.progress.bar?s("rect",{style:t.getSolidStyle,attrs:{id:"elastigantt__tree-row-progress",x:"0",y:"0",width:t.getProgressWidth}}):t._e(),t._v(" "),t.root.state.progress.pattern?s("g",[s("rect",{style:t.root.state.progress.styles.bar.pattern,attrs:{x:t.getProgressWidth,y:"0",width:100-t.task.progress+"%",height:"100%"}}),t._v(" "),s("path",{style:t.getLineStyle,attrs:{d:t.getLinePoints}})]):t._e()])};V._withStripped=!0;var B=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Tree\\ProgressBar.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:V,staticRenderFns:[]},0,H,void 0,!1);const X={components:{TreeText:D,Info:I,ProgressBar:B},inject:["root"],props:["task"],data:()=>({}),computed:{clipPathId(){return"elastigantt__task-clip-path-"+this.task.id},getViewBox(){const t=this.task;return`0 0 ${t.width} ${t.height}`},getGroupTransform(){return`translate(${this.task.x} ${this.task.y})`},getPoints(){const t=this.task;this.task.height,this.task.height,this.task.height;return`0,0 ${t.width},0 ${t.width},${t.height} 0,${t.height}`},getStyle(){return Object.assign({},this.root.state.row.styles.bar,this.task.style)}},methods:{treeRowClick(){this.task.tooltip.visible=!this.task.tooltip.visible},treeRowMouseOver(){this.task.mouseOver=!0},treeRowMouseOut(){this.task.mouseOver=!1}}};var N=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticClass:"elastigantt__tree-row-task-group",on:{mouseover:t.treeRowMouseOver,mouseout:t.treeRowMouseOut}},[s("svg",{staticClass:"elastigantt__tree-row-task",attrs:{x:t.task.x,y:t.task.y,width:t.task.width,height:t.task.height,xmlns:"http://www.w3.org/2000/svg"},on:{click:t.treeRowClick}},[s("defs",[s("clipPath",{attrs:{id:t.clipPathId}},[s("polygon",{attrs:{points:t.getPoints}})])]),t._v(" "),s("polygon",{style:t.getStyle,attrs:{points:t.getPoints}}),t._v(" "),s("progress-bar",{attrs:{task:t.task,"clip-path":"url(#"+t.clipPathId+")"}})],1),t._v(" "),t.root.state.row.showText?s("tree-text",{attrs:{task:t.task}}):t._e(),t._v(" "),t.root.state.info.display&&t.task.mouseOver?s("info",{attrs:{task:t.task}}):t._e()],1)};N._withStripped=!0;var Y=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Tree\\Row\\Task.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:N,staticRenderFns:[]},0,X,void 0,!1);const A={components:{TreeText:D,Info:I,ProgressBar:B},inject:["root"],props:["task"],data:()=>({}),computed:{clipPathId(){return"elastigantt__milestone-clip-path-"+this.task.id},getViewBox(){return`0 0 ${this.task.width} ${this.task.height}`},getGroupTransform(){return`translate(${this.task.x} ${this.task.y})`},getPoints(){const t=this.task,e=t.height/2;let s=e;return t.width/2-s<0&&(s=t.width/2),`0,${e}\n        ${s},0\n        ${t.width-s},0\n        ${t.width},${e}\n        ${t.width-s},${t.height}\n        ${s},${t.height}`},getStyle(){return Object.assign({},this.root.state.row.styles.bar,this.task.style)}},methods:{treeRowClick(){this.task.tooltip.visible=!this.task.tooltip.visible},treeRowMouseOver(){this.task.mouseOver=!0},treeRowMouseOut(){this.task.mouseOver=!1}}};var Z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticClass:"elastigantt__tree-row-milestone-group",on:{mouseover:t.treeRowMouseOver,mouseout:t.treeRowMouseOut}},[s("svg",{staticClass:"elastigantt__tree-row-milestone",attrs:{x:t.task.x,y:t.task.y,width:t.task.width,height:t.task.height,xmlns:"http://www.w3.org/2000/svg"},on:{click:t.treeRowClick}},[s("defs",[s("clipPath",{attrs:{id:t.clipPathId}},[s("polygon",{attrs:{points:t.getPoints}})])]),t._v(" "),s("polygon",{style:t.getStyle,attrs:{points:t.getPoints}}),t._v(" "),s("progress-bar",{attrs:{task:t.task,"clip-path":"url(#"+t.clipPathId+")"}})],1),t._v(" "),t.root.state.row.showText?s("tree-text",{attrs:{task:t.task}}):t._e(),t._v(" "),t.root.state.info.display&&t.task.mouseOver?s("info",{attrs:{task:t.task}}):t._e()],1)};Z._withStripped=!0;var G=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Tree\\Row\\Milestone.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:Z,staticRenderFns:[]},0,A,void 0,!1);const U={components:{TreeText:D,Info:I,ProgressBar:B},inject:["root"],props:["task"],data:()=>({}),computed:{clipPathId(){return"elastigantt__project-clip-path-"+this.task.id},getViewBox(){return`0 0 ${this.task.width} ${this.task.height}`},getGroupTransform(){return`translate(${this.task.x} ${this.task.y})`},getPoints(){const t=this.task;let e=t.height/2;t.width/2-e<0&&(e=t.width/2);const s=t.height-t.height/4,i=t.height/6,a=t.height/8;return`M ${a},0\n                L ${t.width-a} 0\n                L ${t.width} ${a}\n                L ${t.width} ${s}\n                L ${t.width-i} ${t.height}\n                L ${t.width-2*i} ${s}\n                L ${2*i} ${s}\n                L ${i} ${t.height}\n                L 0 ${s}\n                L 0 ${a}\n                Z\n        `},getStyle(){return Object.assign({},this.root.state.row.styles.bar,this.task.style)}},methods:{treeRowClick(){this.task.tooltip.visible=!this.task.tooltip.visible},treeRowMouseOver(){this.task.mouseOver=!0},treeRowMouseOut(){this.task.mouseOver=!1}}};var Q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticClass:"elastigantt__tree-row-project-group",on:{mouseover:t.treeRowMouseOver,mouseout:t.treeRowMouseOut}},[s("svg",{staticClass:"elastigantt__tree-row",attrs:{x:t.task.x,y:t.task.y,width:t.task.width,height:t.task.height,xmlns:"http://www.w3.org/2000/svg"},on:{click:t.treeRowClick}},[s("defs",[s("clipPath",{attrs:{id:t.clipPathId}},[s("path",{style:t.root.state.row.styles.bar,attrs:{d:t.getPoints}})])]),t._v(" "),s("path",{style:t.getStyle,attrs:{d:t.getPoints}}),t._v(" "),s("progress-bar",{attrs:{task:t.task,"clip-path":"url(#"+t.clipPathId+")"}})],1),t._v(" "),t.root.state.row.showText?s("tree-text",{attrs:{task:t.task}}):t._e(),t._v(" "),t.root.state.info.display&&t.task.mouseOver?s("info",{attrs:{task:t.task}}):t._e()],1)};Q._withStripped=!0;const q={components:{Grid:L,DependencyLines:j,Calendar:O,Task:Y,Milestone:G,Project:function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Tree\\Row\\Project.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:Q,staticRenderFns:[]},0,U,void 0,!1)},inject:["root"],data:()=>({}),computed:{getWidth(){return this.root.state.width},getHeight(){return this.root.state.height}}};var J=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("svg",{staticClass:"elastigantt_tree-object",attrs:{x:"0",y:"0",width:t.getWidth,height:t.getHeight,xmlns:"http://www.w3.org/2000/svg"}},[s("calendar"),t._v(" "),s("grid"),t._v(" "),s("dependency-lines",{attrs:{tasks:t.root.visibleTasks}}),t._v(" "),t._l(t.root.visibleTasks,function(t){return s("g",{attrs:{task:t}},[s(t.type,{tag:"component",attrs:{task:t}})],1)})],2)};J._withStripped=!0;const K={components:{TopHeader:o,TaskList:x,Tree:function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Tree\\Tree.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:J,staticRenderFns:[]},0,q,void 0,!1)},inject:["root"],props:["tasks","options"],data:()=>({defs:""}),created(){let t="";try{for(let e=0,s=document.styleSheets.length;e<s;e++){let s=document.styleSheets[e];if("elastigantt__style"===s.title){for(let e=0,i=s.rules.length;e<i;e++){t+=s.rules[e].cssText+"\n"}break}}this.defs=`<style type="text/css">${t}</style>`,this.root.state.defs.push(this.defs)}catch(t){console.log("Cannot add stylesheet to SVG. You must run this app from server.")}},mounted(){this.root.state.svgMain=this.$refs.svgMain,this.root.state.svgTree=this.$refs.svgTree,this.root.state.svgTreeContainer=this.$refs.svgTreeContainer,this.root.state.svgTaskList=this.$refs.svgTaskList,this.root.state.treeScrollContainer=this.$refs.treeScrollContainer},computed:{getWidth(){return this.root.state.width+this.root.state.taskList.finalWidth},getMainStyle(){return{width:this.root.state.width+"px"}},getMarginLeft(){return this.root.state.taskList.display?this.root.state.taskList.finalWidth+"px":"0px"}},methods:{mouseMove(t){this.$root.$emit("elastigantt.main.mousemove",t)},mouseUp(t){this.$root.$emit("elastigantt.main.mouseup",t)},onScroll(t){this.$root.$emit("elastigantt.tree.scroll",t)},onWheel(t){this.$root.$emit("elastigantt.tree.wheel",t)}}};var tt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"elastigantt__main"},[s("top-header"),t._v(" "),s("svg",{ref:"svgMain",staticClass:"elastigantt__svg-container",attrs:{width:t.getWidth,height:t.root.state.height,xmlns:"http://www.w3.org/2000/svg"}},[s("foreignObject",{attrs:{x:"0",y:"0",width:"100%",height:"100%"}},[s("div",{staticClass:"elastigantt__container",attrs:{xmlns:"http://www.w3.org/1999/xhtml"},on:{mousemove:t.mouseMove,mouseup:t.mouseUp}},[s("div",{staticClass:"elastigantt__task-list-container"},[t.root.state.taskList.display?s("svg",{ref:"svgTaskList",staticClass:"elastigantt__task-list-svg",attrs:{xmlns:"http://www.w3.org/2000/svg",width:t.root.state.taskList.finalWidth,height:t.root.state.height}},[s("defs",{domProps:{innerHTML:t._s(t.defs)}}),t._v(" "),s("task-list")],1):t._e()]),t._v(" "),s("div",{ref:"svgTreeContainer",staticClass:"elastigantt__main-container"},[s("svg",{ref:"svgTree",attrs:{xmlns:"http://www.w3.org/2000/svg",width:t.root.state.width,height:t.root.state.height}},[s("defs",{domProps:{innerHTML:t._s(t.defs)}}),t._v(" "),s("tree",{on:{wheel:t.onWheel}})],1)])])])],1),t._v(" "),s("div",{ref:"treeScrollContainer",staticClass:"elastigantt__tree-scroll-container",style:{marginLeft:t.getMarginLeft},on:{scroll:t.onScroll}},[s("div",{staticClass:"elastigantt__tree-scroll",style:{height:"1px",width:t.root.state.width+"px"}})])],1)};tt._withStripped=!0;const et={components:{EgMain:function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\components\\Main.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:tt,staticRenderFns:[]},0,K,void 0,!1)},props:["tasks","options"],provide(){const t={},e=this;return Object.defineProperty(t,"root",{enumerable:!0,get:()=>e}),t},data:()=>({state:{}}),methods:{isObject:t=>t&&"object"==typeof t&&!Array.isArray(t),mergeDeep(t,...e){if(!e.length)return t;const s=e.shift();if(this.isObject(t)&&this.isObject(s))for(const e in s)this.isObject(s[e])?(t[e]||Object.assign(t,{[e]:{}}),this.mergeDeep(t[e],s[e])):Object.assign(t,{[e]:s[e]});return this.mergeDeep(t,...e)},getScrollBarHeight(){const t=document.createElement("div");t.style.visibility="hidden",t.style.height="100px",t.style.msOverflowStyle="scrollbar",document.body.appendChild(t);var e=t.offsetHeight;t.style.overflow="scroll";var s=document.createElement("div");s.style.height="100%",t.appendChild(s);var i=s.offsetHeight;return t.parentNode.removeChild(t),e-i},initialize(){var t;this.state=this.mergeDeep({},(t=this.options,{title:"Elastigantt",debug:!1,width:0,height:0,scroll:{taskList:{left:0,right:0,top:0,bottom:0},tree:{left:0,right:0,percent:0,timePercent:0,top:0,bottom:0,time:0,dateTime:{left:"",right:""}}},svgElement:null,scope:{before:1,after:1},times:{timeScale:6e4,timeZoom:17,timePerPixel:0,fistDate:null,firstTime:null,lastDate:null,lastTime:null,firstTaskDate:null,firstTaskTime:0,lastTaskDate:null,lastTaskTime:0,totalViewDurationMs:0,totalViewDurationPx:0,stepDuration:"day",steps:[]},row:{height:24,styles:{bar:{fill:"#ff0000a0",stroke:"#ff0000","stroke-width":"1"},text:{fill:"#ffffff","font-family":"sans-serif","font-size":"12px"}},showText:!0},treeText:{offset:0,styles:{text:{"font-family":"sans-serif","font-size":"12px","font-weight":"normal",fill:"#000000a0"},background:{fill:"#ffffffb0"}},xPadding:10},dependencyLines:{style:{fill:"transparent",stroke:"#FFa00090","stroke-width":2}},progress:{width:20,height:6,pattern:!0,bar:!0,styles:{line:{stroke:"#ffffff25","stroke-width":20},bar:{pattern:{fill:"url(#diagonalHatch)",transform:"translateY(0.1) scaleY(0.8)"},solid:{fill:"#00ff92a0",height:"20%"}}}},grid:{horizontal:{gap:6,style:{stroke:"#00000010",strokeWidth:1},lines:[]},vertical:{strokeWidth:1,style:{stroke:"#00000010",strokeWidth:1},lines:[]},timeLine:{style:{stroke:"#FF000080",strokeWidth:1}}},info:{style:"fill:#000000a0",textStyle:"fill:#fff",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"bold",display:!1},taskList:{display:!0,styles:{row:{background:"transparent","border-color":"#00000010"},column:{"border-color":"#00000010",height:0,width:0,"line-height":0},header:{background:"#f0f0f0","border-color":"#00000010"},label:{display:"inline-flex",margin:"auto 6px",color:"#404040"},value:{margin:"auto 6px",overflow:"hidden","text-overflow":"ellipsis","line-height":"1.5em","word-break":"keep-all","font-family":"sans-serif","font-size":"12px","white-space":"nowrap",color:"#606060"},expander:{wrapper:{stroke:"#909090",strokeWidth:1,fill:"#ffffffa0",display:"inline-flex","flex-shrink":0},content:{display:"inline-flex",cursor:"pointer",margin:"auto 0px"}}},columns:[{id:0,label:"ID",value:"id",width:40,styles:{label:{}}}],resizerWidth:0,percent:100,width:0,finalWidth:0,expander:{size:16,columnWidth:24,padding:16,margin:10,straight:!0}},calendar:{hours:[],days:[],months:[],gap:6,height:0,styles:{wrapper:{width:"100%",height:"100%",background:"#f0f0f0","border-color":"#00000010"},row:{fill:"transparent",stroke:"#00000010"},column:{stroke:"#00000010","stroke-width":1,fill:"transparent"},text:{fontFamily:"sans-serif",fill:"#404040"}},hour:{height:20,display:!0,fontSize:"12px",widths:[],maxWidths:{},format:{long:e=>dayjs(e).locale(t.locale.code).format("HH:mm"),medium:e=>dayjs(e).locale(t.locale.code).format("HH:mm"),short:e=>dayjs(e).locale(t.locale.code).format("HH")}},day:{height:20,display:!0,fontSize:"12px",widths:[],maxWidths:{},format:{long:e=>dayjs(e).locale(t.locale.code).format("DD dddd"),medium:e=>dayjs(e).locale(t.locale.code).format("DD ddd"),short:e=>dayjs(e).locale(t.locale.code).format("DD")}},month:{height:20,display:!0,fontSize:"12px",widths:[],maxWidths:{},format:{short:e=>dayjs(e).locale(t.locale.code).format("MM"),medium:e=>dayjs(e).locale(t.locale.code).format("'YY MMM"),long:e=>dayjs(e).locale(t.locale.code).format("YYYY MMMM (MM)")}}},defs:[],locale:{code:"en",Now:"Now","X-Scale":"X-Scale","Y-Scale":"Y-Scale","Task list width":"Task list width","Display task list":"Show task list","Before/After":"Before/After"}}),this.options,{tasks:this.tasks.map(t=>this.mergeDeep({},t))}),dayjs.locale(options.locale,null,!0),this.state.taskList.columns=this.state.taskList.columns.map((t,e)=>(t.finalWidth=t.width/100*this.state.taskList.percent,t.styles=this.mergeDeep({},this.state.taskList.styles,t.styles),void 0===t.style&&(t.style={height:"0px","line-height":"0px",width:"0px"}),t.style=this.mergeDeep({},this.state.taskList.styles.column,t.style),void 0===t.height&&(t.height=0),t._id=`${e}-${t.label}`,this.mergeDeep({},t))),this.state.tasks=this.state.tasks.map(t=>(t.x=0,t.y=0,t.width=0,t.height=0,t.tooltip={visible:!1},t.mouseOver=!1,t.dependencyLines=[],void 0===t.visible&&(t.visible=!0),void 0===t.collapsed&&(t.collapsed=!1),void 0===t.dependencyLines&&(t.dependencyLines=[]),void 0===t.dependentOn&&(t.dependentOn=[]),void 0===t.parentId&&(t.parentId=null),void 0===t.style&&(t.style={}),void 0===t.progressBarStyle&&(t.progressBarStyle=this.mergeDeep({},this.state.progress.styles)),t.children=[],t.allChildren=[],t.parents=[],t.parent=null,t.durationMs=0,this.mergeDeep({},t))),this.state.rootTask={id:null,label:"root",children:[],allChildren:[],parents:[],parent:null},this.resetTaskTree(),this.state.taskTree=this.makeTaskTree(this.state.rootTask),this.state.tasks=this.state.taskTree.allChildren,this.state.ctx=document.createElement("canvas").getContext("2d"),this.calculateTaskListColumnsWidths(),this.state.scrollBarHeight=this.getScrollBarHeight(),this.state.outerHeight=this.state.height+this.state.scrollBarHeight},calculateCalendarDimensions(){this.state.calendar.height=0,this.state.calendar.hour.display&&(this.state.calendar.height+=this.state.calendar.hour.height),this.state.calendar.day.display&&(this.state.calendar.height+=this.state.calendar.day.height),this.state.calendar.month.display&&(this.state.calendar.height+=this.state.calendar.month.height)},getMaximalLevel(){let t=0;return this.state.tasks.forEach(e=>{e.parents.length>t&&(t=e.parents.length)}),t-1},getMaximalExpanderWidth(){return this.getMaximalLevel()*this.state.taskList.expander.padding+this.state.taskList.expander.margin},calculateTaskListColumnsWidths(){let t=0;this.state.taskList.columns.forEach(e=>{e.expander?e.finalWidth=(this.getMaximalExpanderWidth()+e.width)/100*this.state.taskList.percent:e.finalWidth=e.width/100*this.state.taskList.percent,t+=e.finalWidth;let s=this.state.row.height+2*this.state.grid.horizontal.gap-this.state.grid.horizontal.strokeWidth;e.style.height=s+"px",e.style["line-height"]=s+"px",e.style.width=e.finalWidth+"px"}),this.state.taskList.finalWidth=t},resetTaskTree(){this.state.rootTask.children=[],this.state.rootTask.allChildren=[],this.state.rootTask.parent=null,this.state.rootTask.parents=[];for(let t=0,e=this.state.tasks.length;t<e;t++){let e=this.state.tasks[t];e.children=[],e.allChildren=[],e.parent=null,e.parents=[]}},makeTaskTree(t){for(let e=0,s=this.state.tasks.length;e<s;e++){let s=this.state.tasks[e];s.parentId===t.id&&(t.parents.length&&t.parents.forEach(t=>s.parents.push(t)),t!==this.root?(s.parents.push(t),s.parent=t):(s.parents=[],s.parent=null),s=this.makeTaskTree(s),t.allChildren.push(s),t.children.push(s),s.allChildren.forEach(e=>t.allChildren.push(e)))}return t},getTask(t){return this.tasksById[t]},getChildren(t){return this.state.tasks.filter(e=>e.parent===t)},getSVG(){return this.state.svgMain.outerHTML},getImage(t="image/png"){return new Promise((e,s)=>{const i=new Image;i.onload=(()=>{const s=document.createElement("canvas");s.width=this.state.svgMain.clientWidth,s.height=this.state.svgMain.clientHeight,s.getContext("2d").drawImage(i,0,0),e(s.toDataURL(t))}),i.src="data:image/svg+xml,"+encodeURIComponent(this.getSVG())})},getHeight(t,e=!1){let s=t.length*(this.state.row.height+2*this.state.grid.horizontal.gap)+this.state.calendar.height+2*this.state.calendar.styles.column["stroke-width"]+this.state.calendar.gap;return e&&(s+=this.state.scrollBarHeight),s},timeToPixelOffsetX(t){let e=t-this.state.times.firstTime;return e&&(e/=this.state.times.timePerPixel),e},pixelOffsetXToTime(t){return(t-this.state.grid.vertical.style.strokeWidth)*this.state.times.timePerPixel+this.state.times.firstTime},isInsideViewPort(t,e,s=5e3){return t+e+s>=this.state.scroll.tree.left&&t-s<=this.state.scroll.tree.right||t-s<=this.state.scroll.tree.left&&t+e+s>=this.state.scroll.tree.right},onScrollTree(t){this._onScrollTree(t.target.scrollLeft,t.target.scrollTop)},_onScrollTree(t,e){const s=this.state.svgTreeContainer.clientWidth;this.state.scroll.tree.left=t,this.state.scroll.tree.right=t+s,this.state.scroll.tree.percent=t/this.state.times.totalViewDurationPx*100,this.state.scroll.tree.top=e,this.state.scroll.tree.time=this.pixelOffsetXToTime(t),this.state.scroll.tree.dateTime.left=dayjs(this.state.scroll.tree.time),this.state.scroll.tree.dateTime.right=dayjs(this.pixelOffsetXToTime(t+this.state.svgTree.clientWidth)),this.state.svgTreeContainer.scrollLeft=t},scrollToTime(t){let e=this.timeToPixelOffsetX(t);const s=this.state.svgTreeContainer.clientWidth;(e-=s/2)>this.state.width&&(e=this.state.width-s),this.scrollTo(e)},scrollTo(t){this.state.svgTreeContainer.scrollLeft=t,this.state.treeScrollContainer.scrollLeft=t},fixScrollPos(){this.$nextTick(()=>{const t=this.state.scroll.tree.percent,e=this.state.times.totalViewDurationPx/100*t;this.scrollTo(e)})},onWheelTree(t){},onTimeZoomChange(t){this.state.times.timeZoom=t,this.recalculateTimes(),this.calculateSteps(),this.calculateCalendarDimensions(),this.fixScrollPos()},onRowHeightChange(t){this.state.row.height=t,this.calculateTaskListColumnsWidths()},onScopeChange(t){this.state.scope.before=t,this.state.scope.after=t,this.initTimes(),this.calculateSteps(),this.computeCalendarWidths(),this.fixScrollPos()},onTaskListWidthChange(t){this.state.taskList.percent=t,this.calculateTaskListColumnsWidths(),this.fixScrollPos()},onTaskListColumnWidthChange(t){this.calculateTaskListColumnsWidths(),this.fixScrollPos()},initializeEvents(){this.$root.$on("elastigantt.tree.scroll",this.onScrollTree),this.$root.$on("elastigantt.tree.wheel",this.onWheelTree),this.$root.$on("elastigantt.times.timeZoom.change",this.onTimeZoomChange),this.$root.$on("elastigantt.row.height.change",this.onRowHeightChange),this.$root.$on("elastigantt.scope.change",this.onScopeChange),this.$root.$on("elastigantt.taskList.width.change",this.onTaskListWidthChange),this.$root.$on("elastigantt.taskList.column.width.change",this.onTaskListColumnWidthChange)},recalculateTimes(){let t=60*this.state.times.timeScale/this.state.times.timeScale,e=this.state.times.timeZoom/100;this.state.times.timePerPixel=this.state.times.timeScale*t*e+Math.pow(2,this.state.times.timeZoom),this.state.times.totalViewDurationMs=this.state.times.lastDate.diff(this.state.times.firstDate,"milisecods"),this.state.times.totalViewDurationPx=this.state.times.totalViewDurationMs/this.state.times.timePerPixel},initTimes(){this.state.times.timeScale,this.state.times.timeScale,this.state.times.timeZoom;this.state.times.firstDate=dayjs(this.state.times.firstTaskDate).locale(this.locale).startOf("day").subtract(this.state.scope.before,"days").startOf("day"),this.state.times.lastDate=dayjs(this.state.times.lastTaskDate).locale(this.locale).endOf("day").add(this.state.scope.after,"days").endOf("day"),this.state.times.firstTime=this.state.times.firstDate.valueOf(),this.state.times.lastTime=this.state.times.lastDate.valueOf(),this.recalculateTimes()},calculateSteps(){const t=[],e=dayjs(this.state.times.lastDate).valueOf(),s=this.state.times.stepDuration,i=dayjs(this.state.times.firstDate);t.push({date:i,offset:{ms:0,px:0}});for(let i=dayjs(this.state.times.firstDate).add(1,s).startOf("day");i.valueOf()<=e;i=i.add(1,s).startOf("day")){const e=i.diff(this.state.times.firstDate,"milisecods"),s=e/this.state.times.timePerPixel,a={date:i,offset:{ms:e,px:s}},r=t[t.length-1];r.width={ms:e-r.offset.ms,px:s-r.offset.px},t.push(a)}const a=t[t.length-1];a.width={ms:this.state.times.totalViewDurationMs-a.offset.ms,px:this.state.times.totalViewDurationPx-a.offset.px},this.state.times.steps=t},computeCalendarWidths(){this.computeDayWidths(),this.computeHourWidths(),this.computeMonthWidths()},computeHourWidths(){const t=this.state;t.ctx.font=t.calendar.hour.fontSize+" "+t.calendar.fontFamily;let e=dayjs("2018-01-01T00:00:00"),s={};Object.keys(t.calendar.hour.format).forEach(t=>{s[t]=0});for(let i=0;i<24;i++){const a={hour:i};Object.keys(t.calendar.hour.format).forEach(s=>{a[s]=t.ctx.measureText(t.calendar.hour.format[s](e.toDate())).width}),t.calendar.hour.widths.push(a),Object.keys(t.calendar.hour.format).forEach(t=>{a[t]>s[t]&&(s[t]=a[t])}),e=e.add(1,"hour")}t.calendar.hour.maxWidths=s},computeDayWidths(){const t=this.state;t.ctx.font=t.calendar.day.fontSize+" "+t.calendar.fontFamily;let e=dayjs(t.times.steps[0].date),s={};Object.keys(t.calendar.day.format).forEach(t=>{s[t]=0});for(let i=0,a=t.times.steps.length;i<a;i++){const a={day:i};Object.keys(t.calendar.day.format).forEach(s=>{a[s]=t.ctx.measureText(t.calendar.day.format[s](e.toDate())).width}),t.calendar.day.widths.push(a),Object.keys(t.calendar.day.format).forEach(t=>{a[t]>s[t]&&(s[t]=a[t])}),e=e.add(1,"day")}t.calendar.day.maxWidths=s},computeMonthWidths(){const t=this.state;t.ctx.font=t.calendar.day.fontSize+" "+t.calendar.fontFamily;let e={};Object.keys(t.calendar.month.format).forEach(t=>{e[t]=0});let s=dayjs(this.state.times.firstDate);const i=Math.ceil(this.state.times.lastDate.diff(this.state.times.firstDate,"months",!0));for(let a=0;a<i;a++){const i={month:a};Object.keys(t.calendar.month.format).forEach(e=>{i[e]=t.ctx.measureText(t.calendar.month.format[e](s.toDate())).width}),t.calendar.month.widths.push(i),Object.keys(t.calendar.month.format).forEach(t=>{i[t]>e[t]&&(e[t]=i[t])}),s=s.add(1,"month")}t.calendar.month.maxWidths=e}},computed:{visibleTasks(){this.state.taskList.width=this.state.taskList.columns.reduce((t,e)=>({width:t.width+e.width}),{width:0}).width,this.state.width=this.state.times.totalViewDurationPx+this.state.grid.vertical.style.strokeWidth,this.resetTaskTree(),this.state.tasks=this.makeTaskTree(this.state.rootTask).allChildren;const t=this.state.tasks.filter(t=>t.visible);this.state.height=this.getHeight(t),this.state.outerHeight=this.getHeight(t,!0);for(let e=0,s=t.length;e<s;e++){let s=t[e];s.width=s.durationMs/this.state.times.timePerPixel-this.state.grid.vertical.style.strokeWidth,s.width<0&&(s.width=0),s.height=this.state.row.height,s.x=this.timeToPixelOffsetX(s.startTime),s.y=(this.state.row.height+2*this.state.grid.horizontal.gap)*e+this.state.grid.horizontal.gap+this.state.calendar.height+this.state.calendar.styles.column["stroke-width"]+this.state.calendar.gap}return t}},created(){this.initialize(),this.initializeEvents(),this.tasksById={},this.state.tasks.forEach(t=>this.tasksById[t.id]=t);this.state.tasks;let t,e,s=Number.MAX_SAFE_INTEGER,i=0;for(let a=0,r=this.state.tasks.length;a<r;a++){let r=this.state.tasks[a];r.startDate=dayjs(r.start),r.startTime=r.startDate.valueOf(),r.durationMs=1e3*r.duration,r.startTime<s&&(s=r.startTime,t=r.startDate),r.startTime+r.durationMs>i&&(i=r.startTime+r.durationMs,e=dayjs(r.startTime+r.durationMs))}this.state.times.firstTaskTime=s,this.state.times.lastTaskTime=i,this.state.times.firstTaskDate=t,this.state.times.lastTaskDate=e,this.state.times.firstDate=dayjs(t).locale(this.locale).startOf("day").subtract(this.state.scope.before,"days").startOf("day"),this.state.times.lastDate=dayjs(e).locale(this.locale).endOf("day").add(this.state.scope.after,"days").endOf("day"),this.initTimes(),this.calculateSteps(),this.computeCalendarWidths(),this.calculateCalendarDimensions()},mounted(){this.$nextTick(()=>{this.$root.$emit("elastigantt.recenterPosition")})}};var st=function(){var t=this.$createElement;return(this._self._c||t)("eg-main",{attrs:{tasks:this.tasks,options:this.options}})};st._withStripped=!0;var it=function(t,e,s,i,a,r,o,n){const l=("function"==typeof s?s.options:s)||{};return l.__file="F:\\elastigantt\\src\\Elastigantt.vue",l.render||(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),l._scopeId=i,l}({render:st,staticRenderFns:[]},0,et,void 0,!1);return{component:it,mount(t){let{el:e,tasks:i,options:a}=t;const r=Object.assign({},s);return r.data=Object.assign({},r.data),r.el=e,r.data={tasks:i,options:a},Vue.component("elastigantt",it),new Vue(r)}}}();
//# sourceMappingURL=elastigantt.standalone.min.js.map
